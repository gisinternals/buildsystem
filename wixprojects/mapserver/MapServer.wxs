<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension" xmlns:iis="http://schemas.microsoft.com/wix/IIsExtension" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">

    <?if $(sys.BUILDARCH) = x64?>
    <?define ProgramFiles = "ProgramFiles64Folder" ?>
    <?ifdef gdal_dll?>
    <?if $(var.Compiler) = 1400?>
    <?define UpgradeCode = "D262F368-DACE-40DE-92AE-17EEF3D4A7BF" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2005 Win64)" ?>
    <?elseif $(var.Compiler) = 1500?>
    <?define UpgradeCode = "9AB50CF4-3BF1-4D11-9391-C06B3C503618" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2008 Win64)" ?>
    <?elseif $(var.Compiler) = 1600?>
    <?define UpgradeCode = "4136470C-DEC2-4207-80EF-28D24619F3FF" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2010 Win64)" ?>
	<?elseif $(var.Compiler) = 1700?>
    <?define UpgradeCode = "52BA80B5-AA39-460A-BB1D-79082111F2E8" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2012 Win64)" ?>
	<?elseif $(var.Compiler) = 1800?>
    <?define UpgradeCode = "20EBF1E3-D8B2-45C6-AC35-AE1613A435FA" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2013 Win64)" ?>
    <?endif?>
    <?endif?>
    <?ifdef msplugin_oracle?>
    <?if $(var.Compiler) = 1400?>
    <?define UpgradeCode = "2E3333E4-F955-4F20-93AB-44830AEB62C3" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2005 Win64)" ?>
    <?elseif $(var.Compiler) = 1500?>
    <?define UpgradeCode = "CF955DDB-ECD7-4375-BA80-8311E3A339E5" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2008 Win64)" ?>
    <?elseif $(var.Compiler) = 1600?>
    <?define UpgradeCode = "7F432EFF-EF2B-4EB7-8A3A-92FF6048458C" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2010 Win64)" ?>
	<?elseif $(var.Compiler) = 1700?>
    <?define UpgradeCode = "09AFDE47-3722-4EA4-9FAE-593A1D0B7811" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2012 Win64)" ?>
	<?elseif $(var.Compiler) = 1800?>
    <?define UpgradeCode = "3BC674AE-A432-44E9-AC89-CDB58FD9D4AB" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2013 Win64)" ?>
    <?endif?>
    <?endif?>
    <?else?>
    <?define ProgramFiles = "ProgramFilesFolder" ?>
    <?ifdef gdal_dll?>
    <?if $(var.Compiler) = 1310?>
    <?define UpgradeCode = "AA937A74-9391-4103-824C-7A67DC55E9B2" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2003)" ?>
    <?elseif $(var.Compiler) = 1400?>
    <?define UpgradeCode = "C596C2DB-42E9-4B7D-BA8C-AD9C7CF1A7C8" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2005)" ?>
    <?elseif $(var.Compiler) = 1500?>
    <?define UpgradeCode = "32F92C2E-62D3-4667-B624-E3E279233010" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2008)" ?>
    <?elseif $(var.Compiler) = 1600?>
    <?define UpgradeCode = "BD05FFAE-6676-4004-9EAC-B1475F87D9E3" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2010)" ?>
	<?elseif $(var.Compiler) = 1700?>
    <?define UpgradeCode = "518322D3-3D79-49D2-9D4A-D3A2A3A7D143" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2012)" ?>
	<?elseif $(var.Compiler) = 1800?>
    <?define UpgradeCode = "91BBF4C0-078A-4431-ADCE-5F93D8A4662B" ?>
    <?define ProductName = "GISInternals MapServer $(var.MSVersionTag) (MSVC 2013)" ?>
    <?endif?>
    <?endif?>
    <?ifdef msplugin_oracle?>
    <?if $(var.Compiler) = 1310?>
    <?define UpgradeCode = "209147FF-8391-48D4-8CFF-D40811BAD3E8" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2003)" ?>
    <?elseif $(var.Compiler) = 1400?>
    <?define UpgradeCode = "93FAAAC3-047F-4F5F-8426-3EA078BACD12" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2005)" ?>
    <?elseif $(var.Compiler) = 1500?>
    <?define UpgradeCode = "BA13E359-FD99-42C3-A6C9-70FA82857FFA" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2008)" ?>
    <?elseif $(var.Compiler) = 1600?>
    <?define UpgradeCode = "6A33DB9A-861A-487C-84B7-CD0C5522DCAA" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2010)" ?>
	<?elseif $(var.Compiler) = 1700?>
    <?define UpgradeCode = "115DB5E9-8B12-4EF4-AF60-D6E49021DC67" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2012)" ?>
	<?elseif $(var.Compiler) = 1700?>
    <?define UpgradeCode = "8B6ECDB4-6DE2-430F-92A5-08C172297558" ?>
    <?define ProductName = "GISInternals MapServer Oracle Plugin $(var.VersionTag) (MSVC 2013)" ?>
    <?endif?>
    <?endif?>
    <?endif?>
    
    <Product Id="*" Name="$(var.ProductName)" Language="1033" Version="1.0.0.0" Manufacturer="GISInternals" UpgradeCode="F70375C2-6571-4A8C-AEA9-3F253A1735E0">
		<Package InstallerVersion="405" Compressed="yes" Description="$(var.ProductName) Installer"/>

    <!-- Check to see if IIS is installed. It it's not, error out. -->
    <Property Id="IIS_MAJOR_VERSION">
        <RegistrySearch Id="CheckIISVersion"
                        Root="HKLM"
                        Key="SOFTWARE\Microsoft\InetStp"
                        Name="MajorVersion"
                        Type="raw"/>
    </Property>

    <Condition Message="IIS must be installed of at least IIS 7 or higher.">
        <![CDATA[Installed OR (IIS_MAJOR_VERSION >= "#7")]]>
    </Condition>

    <!-- The web app name and the web site name. These need to be saved off so 
       the properties get properly set on an uninstall. This way I ensure I'm 
       removing the correct web application. -->
    <Property Id="WEB_APP_NAME" Value="mapserver">
      <RegistrySearch Id="WebAppNameProperty"
                      Root="HKLM"
                      Key="Software\OSGeo\$(var.UpgradeCode)"
                      Name="MapServerWebAppName"
                      Type="raw" />
    </Property>
    <Property Id="WEBSITE_NAME" Value="!(loc.DefaultWebSiteName)">
      <RegistrySearch Id="WebSiteProperty"
                      Root="HKLM"
                      Key="Software\OSGeo\$(var.UpgradeCode)"
                      Name="MapServerWebSiteName"
                      Type="raw" />
    </Property>

    <!-- Holds the app pool for the web application-->
    <Property Id='APP_POOL_NAME' Value='!(loc.DefaultAppPoolName)'/>

		<Media Id="1" Cabinet="MapServer.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="$(var.ProgramFiles)" Name="PFiles">
				<Directory Id="INSTALLDIR" Name="MapServer">
                    <Directory Id="contentDir" Name="content">
                      <?ifdef gdal_dll?>
                      <Component Id="index.html" Guid="*">
                        <File Id="index.html" Name="index.html" Source="$(var.BaseDir)\wixprojects\mapserver\content\index.html" />
                      </Component>
                      <?endif?>
                    </Directory>
                    <Directory Id="licenseDir" Name="license">
                        <?ifdef gdal_dll?>
                        <Component Id="MSLicense.rtf" Guid="*">
                            <File Id="MSLicense.rtf" Name="MSLicense.rtf" Source="$(var.BaseDir)\wixprojects\mapserver\MSLicense.rtf" />
                        </Component>
						<Component Id="GDALLicense.rtf" Guid="*">
                            <File Id="GDALLicense.rtf" Name="GDALLicense.rtf" Source="$(var.BaseDir)\GDALLicense.rtf" />
                        </Component>
                        <Component Id="SZIPLicense.rtf" Guid="*">
                            <File Id="SZIPLicense.rtf" Name="SZIPLicense.rtf" Source="$(var.BaseDir)\SZIPLicense.rtf" />
                        </Component>
                        <Component Id="HDF4License.rtf" Guid="*">
                            <File Id="HDF4License.rtf" Name="HDF4License.rtf" Source="$(var.BaseDir)\HDF4License.rtf" />
                        </Component>
                        <Component Id="HDF5License.rtf" Guid="*">
                            <File Id="HDF5License.rtf" Name="HDF5License.rtf" Source="$(var.BaseDir)\HDF5License.rtf" />
                        </Component>
                        <Component Id="NetCDFLicense.rtf" Guid="*">
                            <File Id="NetCDFLicense.rtf" Name="NetCDFLicense.rtf" Source="$(var.BaseDir)\NetCDFLicense.rtf" />
                        </Component>
                        <Component Id="FITSLicense.rtf" Guid="*">
                            <File Id="FITSLicense.rtf" Name="FITSLicense.rtf" Source="$(var.BaseDir)\FITSLicense.rtf" />
                        </Component>
                        <?endif?>
                        <?ifdef msplugin_oracle?>
                        <Component Id="OCILicense.rtf" Guid="*">
                            <File Id="OCILicense.rtf" Name="OCILicense.rtf" Source="$(var.BaseDir)\wixprojects\mapserver\OCILicense.rtf" />
                        </Component>
                        <?endif?>
                    </Directory>
                    <Directory Id="gdalpluginsDir" Name="gdalplugins">
                        <?ifdef gdal_dll?>
                        <Component Id="gdal_FITS.dll" Guid="*">
                            <File Id="gdal_FITS.dll" Name="gdal_FITS.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_FITS.dll" />
                        </Component>
                        <Component Id="gdal_GMT.dll" Guid="*">
                            <File Id="gdal_GMT.dll" Name="gdal_GMT.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_GMT.dll" />
                        </Component>
                        <Component Id="gdal_HDF5.dll" Guid="*">
                            <File Id="gdal_HDF5.dll" Name="gdal_HDF5.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_HDF5.dll" />
                        </Component>
                        <Component Id="gdal_HDF5Image.dll" Guid="*">
                            <File Id="gdal_HDF5Image.dll" Name="gdal_HDF5Image.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_HDF5Image.dll" />
                        </Component>
						<Component Id="gdal_HDF4.dll" Guid="*">
                            <File Id="gdal_HDF4.dll" Name="gdal_HDF4.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_HDF4.dll" />
                        </Component>
                        <Component Id="gdal_HDF4Image.dll" Guid="*">
                            <File Id="gdal_HDF4Image.dll" Name="gdal_HDF4Image.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_HDF4Image.dll" />
                        </Component>
                        <Component Id="gdal_BAG.dll" Guid="*">
                            <File Id="gdal_BAG.dll" Name="gdal_BAG.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_BAG.dll" />
                        </Component>
                        <Component Id="gdal_netCDF.dll" Guid="*">
                            <File Id="gdal_netCDF.dll" Name="gdal_netCDF.dll" Source="$(var.TargetDir)\gdal\plugins\gdal_netCDF.dll" />
                        </Component>
                        <?endif?>
                    </Directory>
                    <?ifdef gdal_dll?>
                    <Directory Id="projlibDir" Name="projlib">
                        <Component Id="epsg" Guid="*">
                            <File Id="epsg" Name="epsg" Source="$(var.TargetDir)\proj\SHARE\epsg" />
                        </Component>
                        <Component Id="world" Guid="*">
                            <File Id="world" Name="world" Source="$(var.TargetDir)\proj\SHARE\world" Vital="yes"/>
                        </Component>
                        <Component Id="WO" Guid="*">
                            <File Id="WO" Name="WO" Source="$(var.TargetDir)\proj\SHARE\WO" Vital="yes"/>
                        </Component>
                        <Component Id="WI" Guid="*">
                            <File Id="WI" Name="WI" Source="$(var.TargetDir)\proj\SHARE\WI" Vital="yes"/>
                        </Component>
                        <Component Id="TN" Guid="*">
                            <File Id="TN" Name="TN" Source="$(var.TargetDir)\proj\SHARE\TN" Vital="yes"/>
                        </Component>
                        <Component Id="stpaul" Guid="*">
                            <File Id="stpaul" Name="stpaul" Source="$(var.TargetDir)\proj\SHARE\stpaul" Vital="yes"/>
                        </Component>
                        <Component Id="stlrnc" Guid="*">
                            <File Id="stlrnc" Name="stlrnc" Source="$(var.TargetDir)\proj\SHARE\stlrnc" Vital="yes"/>
                        </Component>
                        <Component Id="stgeorge" Guid="*">
                            <File Id="stgeorge" Name="stgeorge" Source="$(var.TargetDir)\proj\SHARE\stgeorge" Vital="yes"/>
                        </Component>
                        <Component Id="prvi" Guid="*">
                            <File Id="prvi" Name="prvi" Source="$(var.TargetDir)\proj\SHARE\prvi" Vital="yes"/>
                        </Component>
                        <Component Id="proj_def.dat" Guid="*">
                            <File Id="proj_def.dat" Name="proj_def.dat" Source="$(var.TargetDir)\proj\SHARE\proj_def.dat" Vital="yes"/>
                        </Component>
                        <Component Id="other.extra" Guid="*">
                            <File Id="other.extra" Name="other.extra" Source="$(var.TargetDir)\proj\SHARE\other.extra" Vital="yes"/>
                        </Component>
                        <Component Id="nzgd2kgrid0005.gsb" Guid="*">
                            <File Id="nzgd2kgrid0005.gsb" Name="nzgd2kgrid0005.gsb" Source="$(var.TargetDir)\proj\SHARE\nzgd2kgrid0005.gsb" Vital="yes"/>
                        </Component>
                        <Component Id="null" Guid="*">
                            <File Id="null" Name="null" Source="$(var.TargetDir)\proj\SHARE\null" Vital="yes"/>
                        </Component>
                        <Component Id="ntv1_can.dat" Guid="*">
                            <File Id="ntv1_can.dat" Name="ntv1_can.dat" Source="$(var.TargetDir)\proj\SHARE\ntv1_can.dat" Vital="yes"/>
                        </Component>
                        <Component Id="ntf_r93.gsb" Guid="*">
                            <File Id="ntf_r93.gsb" Name="ntf_r93.gsb" Source="$(var.TargetDir)\proj\SHARE\ntf_r93.gsb" Vital="yes"/>
                        </Component>
                        <Component Id="nad83" Guid="*">
                            <File Id="nad83" Name="nad83" Source="$(var.TargetDir)\proj\SHARE\nad83" Vital="yes"/>
                        </Component>
                        <Component Id="nad27" Guid="*">
                            <File Id="nad27" Name="nad27" Source="$(var.TargetDir)\proj\SHARE\nad27" Vital="yes"/>
                        </Component>
                        <Component Id="nad.lst" Guid="*">
                            <File Id="nad.lst" Name="nad.lst" Source="$(var.TargetDir)\proj\SHARE\nad.lst" Vital="yes"/>
                        </Component>
                        <Component Id="MD" Guid="*">
                            <File Id="MD" Name="MD" Source="$(var.TargetDir)\proj\SHARE\MD" Vital="yes"/>
                        </Component>
                        <Component Id="IGNF" Guid="*">
                            <File Id="IGNF" Name="IGNF" Source="$(var.TargetDir)\proj\SHARE\IGNF" Vital="yes"/>
                        </Component>
                        <Component Id="hawaii" Guid="*">
                            <File Id="hawaii" Name="hawaii" Source="$(var.TargetDir)\proj\SHARE\hawaii" Vital="yes"/>
                        </Component>
                        <Component Id="GL27" Guid="*">
                            <File Id="GL27" Name="GL27" Source="$(var.TargetDir)\proj\SHARE\GL27" Vital="yes"/>
                        </Component>
                        <Component Id="esri.extra" Guid="*">
                            <File Id="esri.extra" Name="esri.extra" Source="$(var.TargetDir)\proj\SHARE\esri.extra" Vital="yes"/>
                        </Component>
                        <Component Id="esri" Guid="*">
                            <File Id="esri" Name="esri" Source="$(var.TargetDir)\proj\SHARE\esri" Vital="yes"/>
                        </Component>
                        <Component Id="conus" Guid="*">
                            <File Id="conus" Name="conus" Source="$(var.TargetDir)\proj\SHARE\conus" Vital="yes"/>
                        </Component>
                        <Component Id="alaska" Guid="*">
                            <File Id="alaska" Name="alaska" Source="$(var.TargetDir)\proj\SHARE\alaska" Vital="yes"/>
                        </Component>
                    </Directory>
                    <Component Id="IIS.Component" Guid="0C60B669-4285-4281-99A8-ACB5B93EF28B" KeyPath="yes">
                        <iis:WebVirtualDir Id="MapServer.VirtualDir" Alias="[WEB_APP_NAME]" Directory="INSTALLDIR" WebSite="TheWebSite">
                            <iis:WebApplication Id="MapServerApp" Name="MapServer" WebAppPool="TheAppPool"/> 
                        </iis:WebVirtualDir>
                        <CreateFolder/>
                    </Component>
                    <Component Id="AppWebConfig" Guid="D1A0B1B2-931D-4D5E-835D-79F1A597C31E">
                       <File Id="web.config" Name="web.config" Vital="yes" KeyPath="yes" Source="$(var.BaseDir)\wixprojects\mapserver\web.config" />
                       <util:XmlFile Id="WebConfigSetScriptProcessor" Action="setValue" Permanent="yes" File="[#web.config]"        	
                            ElementPath="/configuration/system.webServer/handlers/add[\[]@name='MapServer CGI'[\]]" Name="scriptProcessor" 
                            Value="[INSTALLDIR]mapserv.exe" />
                    </Component>
                    <!-- The component for installer properties I need to save so they can 
                         be used on the uninstall. -->
                    <Component Id="SetupRegistryValues" Guid="864A5982-5B28-4451-83DE-87521FCFF90A" KeyPath="yes">
                      <RegistryValue Root="HKLM" Key="Software\OSGeo\$(var.UpgradeCode)"
                                     Name="MapServerWebAppName"
                                     Value="[WEB_APP_NAME]"
                                     Type="string" />
                      <RegistryValue Root="HKLM" Key="Software\OSGeo\$(var.UpgradeCode)"
                                     Name="MapServerWebSiteName"
                                     Value="[WEBSITE_NAME]"
                                     Type="string"/>
                    </Component>
                    <Component Id="mapserver.dll" Guid="*">
                        <File Id="mapserver.dll" Name="mapserver.dll" Source="$(var.TargetDir)\mapserver.dll" Vital="yes"/>
                    </Component>
                    <Component Id="cairo.dll" Guid="*">
                        <File Id="cairo.dll" Name="cairo.dll" Source="$(var.TargetDir)\cairo.dll" Vital="yes"/>
                    </Component>
                    <Component Id="fribidi.dll" Guid="*">
                        <File Id="fribidi.dll" Name="fribidi.dll" Source="$(var.TargetDir)\fribidi.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libfcgi.dll" Guid="*">
                        <File Id="libfcgi.dll" Name="libfcgi.dll" Source="$(var.TargetDir)\libfcgi.dll" Vital="yes"/>
                    </Component>
                    <Component Id="legend.exe" Guid="*">
                        <File Id="legend.exe" Name="legend.exe" Source="$(var.TargetDir)\ms\apps\legend.exe"/>
                    </Component>
                    <Component Id="mapserv.exe" Guid="*">
                        <File Id="mapserv.exe" Name="mapserv.exe" Source="$(var.TargetDir)\ms\apps\mapserv.exe" Vital="yes"/>
                    </Component>
                    <Component Id="msencrypt.exe" Guid="*">
                        <File Id="msencrypt.exe" Name="msencrypt.exe" Source="$(var.TargetDir)\ms\apps\msencrypt.exe"/>
                    </Component>
                    <Component Id="scalebar.exe" Guid="*">
                        <File Id="scalebar.exe" Name="scalebar.exe" Source="$(var.TargetDir)\ms\apps\scalebar.exe"/>
                    </Component>
                    <Component Id="shp2img.exe" Guid="*">
                        <File Id="shp2img.exe" Name="shp2img.exe" Source="$(var.TargetDir)\ms\apps\shp2img.exe"/>
                    </Component>
                    <Component Id="shptree.exe" Guid="*">
                        <File Id="shptree.exe" Name="shptree.exe" Source="$(var.TargetDir)\ms\apps\shptree.exe"/>
                    </Component>
                    <Component Id="shptreevis.exe" Guid="*">
                        <File Id="shptreevis.exe" Name="shptreevis.exe" Source="$(var.TargetDir)\ms\apps\shptreevis.exe"/>
                    </Component>
                    <Component Id="sortshp.exe" Guid="*">
                        <File Id="sortshp.exe" Name="sortshp.exe" Source="$(var.TargetDir)\ms\apps\sortshp.exe" Vital="yes"/>
                    </Component>
                    <Component Id="tile4ms.exe" Guid="*">
                        <File Id="tile4ms.exe" Name="tile4ms.exe" Source="$(var.TargetDir)\ms\apps\tile4ms.exe" Vital="yes"/>
                    </Component>
                    <Component Id="cfitsio.dll" Guid="*">
                        <File Id="cfitsio.dll" Name="cfitsio.dll" Source="$(var.TargetDir)\cfitsio.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdal.dll" Guid="*">
                        <File Id="gdal.dll" Name="$(var.gdal_dll)" Source="$(var.TargetDir)\$(var.gdal_dll)" Vital="yes"/>
                    </Component>
                    <Component Id="geos_c.dll" Guid="*">
                        <File Id="geos_c.dll" Name="geos_c.dll" Source="$(var.TargetDir)\geos_c.dll" Vital="yes"/>
                    </Component>
					<Component Id="geos.dll" Guid="*">
                        <File Id="geos.dll" Name="geos.dll" Source="$(var.TargetDir)\geos.dll" Vital="yes"/>
                    </Component>
                    <Component Id="hdf5.dll" Guid="*">
                        <File Id="hdf5.dll" Name="hdf5.dll" Source="$(var.TargetDir)\hdf5.dll" Vital="yes"/>
                    </Component>
                    <Component Id="hdf5_hl.dll" Guid="*">
                        <File Id="hdf5_hl.dll" Name="hdf5_hl.dll" Source="$(var.TargetDir)\hdf5_hl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="hdfdll.dll" Guid="*">
                        <File Id="hdfdll.dll" Name="hdfdll.dll" Source="$(var.TargetDir)\hdfdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="mfhdfdll.dll" Guid="*">
                        <File Id="mfhdfdll.dll" Name="mfhdfdll.dll" Source="$(var.TargetDir)\mfhdfdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="xdrdll.dll" Guid="*">
                        <File Id="xdrdll.dll" Name="xdrdll.dll" Source="$(var.TargetDir)\xdrdll.dll" Vital="yes"/>
                    </Component>
                    <Component Id="szip.dll" Guid="*">
                        <File Id="szip.dll" Name="szip.dll" Source="$(var.TargetDir)\szip.dll" Vital="yes"/>
                    </Component>
                    <Component Id="iconv.dll" Guid="*">
                        <File Id="iconv.dll" Name="iconv.dll" Source="$(var.TargetDir)\iconv.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libcurl.dll" Guid="*">
                        <File Id="libcurl.dll" Name="libcurl.dll" Source="$(var.TargetDir)\libcurl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libeay32.dll" Guid="*">
                        <File Id="libeay32.dll" Name="libeay32.dll" Source="$(var.TargetDir)\libeay32.dll" Vital="yes"/>
                    </Component>
                    <Component Id="expat.dll" Guid="*">
                        <File Id="expat.dll" Name="expat.dll" Source="$(var.TargetDir)\expat.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libmysql.dll" Guid="*">
                        <File Id="libmysql.dll" Name="libmysql.dll" Source="$(var.TargetDir)\libmysql.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libpq.dll" Guid="*">
                        <File Id="libpq.dll" Name="libpq.dll" Source="$(var.TargetDir)\libpq.dll" Vital="yes"/>
                    </Component>
                    <Component Id="libxml2.dll" Guid="*">
                        <File Id="libxml2.dll" Name="libxml2.dll" Source="$(var.TargetDir)\libxml2.dll" Vital="yes"/>
                    </Component>
                    <?if $(var.Compiler) = 1310?>
                    <Component Id="msvcr71.dll" Guid="*">
                        <File Id="msvcr71.dll" Name="msvcr71.dll" Source="$(var.TargetDir)\msvcr71.dll" Vital="yes"/>
                    </Component>
                    <Component Id="msvcp71.dll" Guid="*">
                        <File Id="msvcp71.dll" Name="msvcp71.dll" Source="$(var.TargetDir)\msvcp71.dll" Vital="yes"/>
                    </Component>
                    <?endif?>
                    <Component Id="netcdf.dll" Guid="*">
                        <File Id="netcdf.dll" Name="netcdf.dll" Source="$(var.TargetDir)\netcdf.dll" Vital="yes"/>
                    </Component>
                    <Component Id="openjp2.dll" Guid="*">
                        <File Id="openjp2.dll" Name="openjp2.dll" Source="$(var.TargetDir)\openjp2.dll" Vital="yes"/>
                    </Component>
                    <Component Id="proj.dll" Guid="*">
                        <File Id="proj.dll" Name="proj.dll" Source="$(var.TargetDir)\proj.dll" Vital="yes"/>
                    </Component>
                    <Component Id="spatialite.dll" Guid="*">
                        <File Id="spatialite.dll" Name="spatialite.dll" Source="$(var.TargetDir)\spatialite.dll" Vital="yes"/>
                    </Component>
					<Component Id="sqlite3.dll" Guid="*">
                        <File Id="sqlite3.dll" Name="sqlite3.dll" Source="$(var.TargetDir)\sqlite3.dll" Vital="yes"/>
                    </Component>
					<Component Id="freexl.dll" Guid="*">
                        <File Id="freexl.dll" Name="freexl.dll" Source="$(var.TargetDir)\freexl.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ssleay32.dll" Guid="*">
                        <File Id="ssleay32.dll" Name="ssleay32.dll" Source="$(var.TargetDir)\ssleay32.dll" Vital="yes"/>
                    </Component>
                    <Component Id="xerces_c_3_1.dll" Guid="*">
                        <File Id="xerces_c_3_1.dll" Name="xerces-c_3_1.dll" Source="$(var.TargetDir)\xerces-c_3_1.dll" Vital="yes"/>
                    </Component>
                    <Component Id="zlib1.dll" Guid="*">
                        <File Id="zlib1.dll" Name="zlib1.dll" Source="$(var.TargetDir)\zlib1.dll" Vital="yes"/>
                    </Component>
                    <Component Id="curl_ca_bundle.crt" Guid="*">
                        <File Id="curl_ca_bundle.crt" Name="curl-ca-bundle.crt" Source="$(var.TargetDir)\curl\curl-ca-bundle.crt" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_contour.exe" Guid="*">
                        <File Id="gdal_contour.exe" Name="gdal_contour.exe" Source="$(var.TargetDir)\gdal\apps\gdal_contour.exe" />
                    </Component>
                    <Component Id="gdal_grid.exe" Guid="*">
                        <File Id="gdal_grid.exe" Name="gdal_grid.exe" Source="$(var.TargetDir)\gdal\apps\gdal_grid.exe" />
                    </Component>
                    <Component Id="gdal_rasterize.exe" Guid="*">
                        <File Id="gdal_rasterize.exe" Name="gdal_rasterize.exe" Source="$(var.TargetDir)\gdal\apps\gdal_rasterize.exe" />
                    </Component>
                    <Component Id="gdal_translate.exe" Guid="*">
                        <File Id="gdal_translate.exe" Name="gdal_translate.exe" Source="$(var.TargetDir)\gdal\apps\gdal_translate.exe" />
                    </Component>
                    <Component Id="gdaladdo.exe" Guid="*">
                        <File Id="gdaladdo.exe" Name="gdaladdo.exe" Source="$(var.TargetDir)\gdal\apps\gdaladdo.exe" />
                    </Component>
                    <Component Id="gdalbuildvrt.exe" Guid="*">
                        <File Id="gdalbuildvrt.exe" Name="gdalbuildvrt.exe" Source="$(var.TargetDir)\gdal\apps\gdalbuildvrt.exe" />
                    </Component>
                    <Component Id="gdaldem.exe" Guid="*">
                        <File Id="gdaldem.exe" Name="gdaldem.exe" Source="$(var.TargetDir)\gdal\apps\gdaldem.exe" />
                    </Component>
                    <Component Id="gdalenhance.exe" Guid="*">
                        <File Id="gdalenhance.exe" Name="gdalenhance.exe" Source="$(var.TargetDir)\gdal\apps\gdalenhance.exe" />
                    </Component>
                    <Component Id="gdalinfo.exe" Guid="*">
                        <File Id="gdalinfo.exe" Name="gdalinfo.exe" Source="$(var.TargetDir)\gdal\apps\gdalinfo.exe" />
                    </Component>
                    <Component Id="gdallocationinfo.exe" Guid="*">
                        <File Id="gdallocationinfo.exe" Name="gdallocationinfo.exe" Source="$(var.TargetDir)\gdal\apps\gdallocationinfo.exe" />
                    </Component>
                    <Component Id="gdalmanage.exe" Guid="*">
                        <File Id="gdalmanage.exe" Name="gdalmanage.exe" Source="$(var.TargetDir)\gdal\apps\gdalmanage.exe" />
                    </Component>
                    <Component Id="gdaltindex.exe" Guid="*">
                        <File Id="gdaltindex.exe" Name="gdaltindex.exe" Source="$(var.TargetDir)\gdal\apps\gdaltindex.exe" />
                    </Component>
                    <Component Id="gdaltransform.exe" Guid="*">
                        <File Id="gdaltransform.exe" Name="gdaltransform.exe" Source="$(var.TargetDir)\gdal\apps\gdaltransform.exe" />
                    </Component>
                    <Component Id="gdalwarp.exe" Guid="*">
                        <File Id="gdalwarp.exe" Name="gdalwarp.exe" Source="$(var.TargetDir)\gdal\apps\gdalwarp.exe" />
                    </Component>
                    <Component Id="nearblack.exe" Guid="*">
                        <File Id="nearblack.exe" Name="nearblack.exe" Source="$(var.TargetDir)\gdal\apps\nearblack.exe" />
                    </Component>
                    <Component Id="ogr2ogr.exe" Guid="*">
                        <File Id="ogr2ogr.exe" Name="ogr2ogr.exe" Source="$(var.TargetDir)\gdal\apps\ogr2ogr.exe" />
                    </Component>
                    <Component Id="ogrinfo.exe" Guid="*">
                        <File Id="ogrinfo.exe" Name="ogrinfo.exe" Source="$(var.TargetDir)\gdal\apps\ogrinfo.exe" />
                    </Component>
                    <Component Id="ogrtindex.exe" Guid="*">
                        <File Id="ogrtindex.exe" Name="ogrtindex.exe" Source="$(var.TargetDir)\gdal\apps\ogrtindex.exe" />
                    </Component>
                    <Component Id="curl.exe" Guid="*">
                        <File Id="curl.exe" Name="curl.exe" Source="$(var.TargetDir)\curl\curl.exe" />
                    </Component>
                    <Component Id="openssl.exe" Guid="*">
                        <File Id="openssl.exe" Name="openssl.exe" Source="$(var.TargetDir)\curl\openssl.exe" />
                    </Component>
                    <Component Id="cs2cs.exe" Guid="*">
                        <File Id="cs2cs.exe" Name="cs2cs.exe" Source="$(var.TargetDir)\proj\apps\cs2cs.exe" />
                    </Component>
                    <Component Id="geod.exe" Guid="*">
                        <File Id="geod.exe" Name="geod.exe" Source="$(var.TargetDir)\proj\apps\geod.exe" />
                    </Component>
                    <Component Id="nad2bin.exe" Guid="*">
                        <File Id="nad2bin.exe" Name="nad2bin.exe" Source="$(var.TargetDir)\proj\apps\nad2bin.exe" />
                    </Component>
                    <Component Id="proj.exe" Guid="*">
                        <File Id="proj.exe" Name="proj.exe" Source="$(var.TargetDir)\proj\apps\proj.exe" />
                    </Component>
                    <Component Id="gdalconstjni.dll" Guid="*">
                        <File Id="gdalconstjni.dll" Name="gdalconstjni.dll" Source="$(var.TargetDir)\gdal\java\gdalconstjni.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdaljni.dll" Guid="*">
                        <File Id="gdaljni.dll" Name="gdaljni.dll" Source="$(var.TargetDir)\gdal\java\gdaljni.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ogrjni.dll" Guid="*">
                        <File Id="ogrjni.dll" Name="ogrjni.dll" Source="$(var.TargetDir)\gdal\java\ogrjni.dll" Vital="yes"/>
                    </Component>
                    <Component Id="osrjni.dll" Guid="*">
                        <File Id="osrjni.dll" Name="osrjni.dll" Source="$(var.TargetDir)\gdal\java\osrjni.dll" Vital="yes"/>
                    </Component>
                    <Component Id="ogr_wrap.dll" Guid="*">
                        <File Id="ogr_wrap.dll" Name="ogr_wrap.dll" Source="$(var.TargetDir)\gdal\csharp\ogr_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="osr_wrap.dll" Guid="*">
                        <File Id="osr_wrap.dll" Name="osr_wrap.dll" Source="$(var.TargetDir)\gdal\csharp\osr_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_wrap.dll" Guid="*">
                        <File Id="gdal_wrap.dll" Name="gdal_wrap.dll" Source="$(var.TargetDir)\gdal\csharp\gdal_wrap.dll" Vital="yes"/>
                    </Component>
                    <Component Id="MSShell.bat" Guid="*">
                        <File Id="MSShell.bat" Name="MSShell.bat" Source="$(var.BaseDir)\wixprojects\mapserver\MSShell.bat" Vital="yes"/>
                    </Component>
                    <Component Id="epsg_tr.py" Guid="*">
                        <File Id="epsg_tr.py" Name="epsg_tr.py" Source="$(var.TargetDir)\gdal\python\scripts\epsg_tr.py" Vital="yes"/>
                    </Component>
                    <Component Id="esri2wkt.py" Guid="*">
                        <File Id="esri2wkt.py" Name="esri2wkt.py" Source="$(var.TargetDir)\gdal\python\scripts\esri2wkt.py" Vital="yes"/>
                    </Component>
                    <Component Id="gcps2vec.py" Guid="*">
                        <File Id="gcps2vec.py" Name="gcps2vec.py" Source="$(var.TargetDir)\gdal\python\scripts\gcps2vec.py" Vital="yes"/>
                    </Component>
                    <Component Id="gcps2wld.py" Guid="*">
                        <File Id="gcps2wld.py" Name="gcps2wld.py" Source="$(var.TargetDir)\gdal\python\scripts\gcps2wld.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal2tiles.py" Guid="*">
                        <File Id="gdal2tiles.py" Name="gdal2tiles.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal2tiles.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal2xyz.py" Guid="*">
                        <File Id="gdal2xyz.py" Name="gdal2xyz.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal2xyz.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_fillnodata.py" Guid="*">
                        <File Id="gdal_fillnodata.py" Name="gdal_fillnodata.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_fillnodata.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_merge.py" Guid="*">
                        <File Id="gdal_merge.py" Name="gdal_merge.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_merge.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_polygonize.py" Guid="*">
                        <File Id="gdal_polygonize.py" Name="gdal_polygonize.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_polygonize.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_proximity.py" Guid="*">
                        <File Id="gdal_proximity.py" Name="gdal_proximity.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_proximity.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_retile.py" Guid="*">
                        <File Id="gdal_retile.py" Name="gdal_retile.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_retile.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdal_sieve.py" Guid="*">
                        <File Id="gdal_sieve.py" Name="gdal_sieve.py" Source="$(var.TargetDir)\gdal\python\scripts\gdal_sieve.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdalchksum.py" Guid="*">
                        <File Id="gdalchksum.py" Name="gdalchksum.py" Source="$(var.TargetDir)\gdal\python\scripts\gdalchksum.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdalident.py" Guid="*">
                        <File Id="gdalident.py" Name="gdalident.py" Source="$(var.TargetDir)\gdal\python\scripts\gdalident.py" Vital="yes"/>
                    </Component>
                    <Component Id="gdalimport.py" Guid="*">
                        <File Id="gdalimport.py" Name="gdalimport.py" Source="$(var.TargetDir)\gdal\python\scripts\gdalimport.py" Vital="yes"/>
                    </Component>
                    <Component Id="mkgraticule.py" Guid="*">
                        <File Id="mkgraticule.py" Name="mkgraticule.py" Source="$(var.TargetDir)\gdal\python\scripts\mkgraticule.py" Vital="yes"/>
                    </Component>
                    <Component Id="pct2rgb.py" Guid="*">
                        <File Id="pct2rgb.py" Name="pct2rgb.py" Source="$(var.TargetDir)\gdal\python\scripts\pct2rgb.py" Vital="yes"/>
                    </Component>
                    <Component Id="rgb2pct.py" Guid="*">
                        <File Id="rgb2pct.py" Name="rgb2pct.py" Source="$(var.TargetDir)\gdal\python\scripts\rgb2pct.py" Vital="yes"/>
                    </Component>
                    <Directory Id="csharpDir" Name="csharp">
                        <Component Id="ogr_csharp.dll" Guid="*">
                            <File Id="ogr_csharp.dll" Name="ogr_csharp.dll" Source="$(var.TargetDir)\gdal\csharp\ogr_csharp.dll" Vital="yes"/>
                        </Component>
                        <Component Id="osr_csharp.dll" Guid="*">
                            <File Id="osr_csharp.dll" Name="osr_csharp.dll" Source="$(var.TargetDir)\gdal\csharp\osr_csharp.dll" Vital="yes"/>
                        </Component>
                        <Component Id="gdal_csharp.dll" Guid="*">
                            <File Id="gdal_csharp.dll" Name="gdal_csharp.dll" Source="$(var.TargetDir)\gdal\csharp\gdal_csharp.dll" Vital="yes"/>
                        </Component>
                    </Directory>
                    <Directory Id="javaDir" Name="java">
                        <Component Id="gdal.jar" Guid="*">
                            <File Id="gdal.jar" Name="gdal.jar" Source="$(var.TargetDir)\gdal\java\gdal.jar" Vital="yes"/>
                        </Component>
                    </Directory>
					<Directory Id="imgDir" Name="img">
                        <Component Id="blank.gif" Guid="*">
                            <File Id="blank.gif" Name="blank.gif" Source="$(var.BaseDir)\wixprojects\mapserver\img\blank.gif" Vital="yes"/>
                        </Component>
						<Component Id="east_mini.png" Guid="*">
                            <File Id="east_mini.png" Name="east-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\east-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="west_mini.png" Guid="*">
                            <File Id="west_mini.png" Name="west-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\west-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="north_mini.png" Guid="*">
                            <File Id="north_mini.png" Name="north-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\north-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="south_mini.png" Guid="*">
                            <File Id="south_mini.png" Name="south-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\south-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="zoom_minus_mini.png" Guid="*">
                            <File Id="zoom_minus_mini.png" Name="zoom-minus-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\zoom-minus-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="zoom_plus_mini.png" Guid="*">
                            <File Id="zoom_plus_mini.png" Name="zoom-plus-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\zoom-plus-mini.png" Vital="yes"/>
                        </Component>
						<Component Id="zoom_world_mini.png" Guid="*">
                            <File Id="zoom_world_mini.png" Name="zoom-world-mini.png" Source="$(var.BaseDir)\wixprojects\mapserver\img\zoom-world-mini.png" Vital="yes"/>
                        </Component>
                    </Directory>
					<Directory Id="themeDir" Name="theme">
						<Directory Id="defaultDir" Name="default">
							<Component Id="style.css" Guid="*">
								<File Id="style.css" Name="style.css" Source="$(var.BaseDir)\wixprojects\mapserver\theme\default\style.css" Vital="yes"/>
							</Component>
						</Directory>
					</Directory>
                    <Directory Id="gdaldataDir" Name="gdal-data">
                        <Component Id="ecw_cs.wkt" Guid="*">
                            <File Id="ecw_cs.wkt" Name="ecw_cs.wkt" Source="$(var.TargetDir)\gdal-data\ecw_cs.wkt" Vital="yes"/>
                        </Component>
                        <Component Id="cubewerx_extra.wkt" Guid="*">
                            <File Id="cubewerx_extra.wkt" Name="cubewerx_extra.wkt" Source="$(var.TargetDir)\gdal-data\cubewerx_extra.wkt" Vital="yes"/>
                        </Component>
                        <Component Id="epsg.wkt" Guid="*">
                            <File Id="epsg.wkt" Name="epsg.wkt" Source="$(var.TargetDir)\gdal-data\epsg.wkt" Vital="yes"/>
                        </Component>
                        <Component Id="esri_extra.wkt" Guid="*">
                            <File Id="esri_extra.wkt" Name="esri_extra.wkt" Source="$(var.TargetDir)\gdal-data\esri_extra.wkt" Vital="yes"/>
                        </Component>
                        <Component Id="coordinate_axis.csv" Guid="*">
                            <File Id="coordinate_axis.csv" Name="coordinate_axis.csv" Source="$(var.TargetDir)\gdal-data\coordinate_axis.csv" Vital="yes"/>
                        </Component>
                        <Component Id="ellipsoid.csv" Guid="*">
                            <File Id="ellipsoid.csv" Name="ellipsoid.csv" Source="$(var.TargetDir)\gdal-data\ellipsoid.csv" Vital="yes"/>
                        </Component>
                        <Component Id="gcs.csv" Guid="*">
                            <File Id="gcs.csv" Name="gcs.csv" Source="$(var.TargetDir)\gdal-data\gcs.csv" Vital="yes"/>
                        </Component>
                        <Component Id="gcs.override.csv" Guid="*">
                            <File Id="gcs.override.csv" Name="gcs.override.csv" Source="$(var.TargetDir)\gdal-data\gcs.override.csv" Vital="yes"/>
                        </Component>
                        <Component Id="gdal_datum.csv" Guid="*">
                            <File Id="gdal_datum.csv" Name="gdal_datum.csv" Source="$(var.TargetDir)\gdal-data\gdal_datum.csv" Vital="yes"/>
                        </Component>
                        <Component Id="gt_datum.csv" Guid="*">
                            <File Id="gt_datum.csv" Name="gt_datum.csv" Source="$(var.TargetDir)\gdal-data\gt_datum.csv" Vital="yes"/>
                        </Component>
                        <Component Id="gt_ellips.csv" Guid="*">
                            <File Id="gt_ellips.csv" Name="gt_ellips.csv" Source="$(var.TargetDir)\gdal-data\gt_ellips.csv" Vital="yes"/>
                        </Component>
                        <Component Id="pcs.csv" Guid="*">
                            <File Id="pcs.csv" Name="pcs.csv" Source="$(var.TargetDir)\gdal-data\pcs.csv" Vital="yes"/>
                        </Component>
                        <Component Id="pcs.override.csv" Guid="*">
                            <File Id="pcs.override.csv" Name="pcs.override.csv" Source="$(var.TargetDir)\gdal-data\pcs.override.csv" Vital="yes"/>
                        </Component>
                        <Component Id="prime_meridian.csv" Guid="*">
                            <File Id="prime_meridian.csv" Name="prime_meridian.csv" Source="$(var.TargetDir)\gdal-data\prime_meridian.csv" Vital="yes"/>
                        </Component>
                        <Component Id="projop_wparm.csv" Guid="*">
                            <File Id="projop_wparm.csv" Name="projop_wparm.csv" Source="$(var.TargetDir)\gdal-data\projop_wparm.csv" Vital="yes"/>
                        </Component>
                        <Component Id="s57agencies.csv" Guid="*">
                            <File Id="s57agencies.csv" Name="s57agencies.csv" Source="$(var.TargetDir)\gdal-data\s57agencies.csv" Vital="yes"/>
                        </Component>
                        <Component Id="s57attributes.csv" Guid="*">
                            <File Id="s57attributes.csv" Name="s57attributes.csv" Source="$(var.TargetDir)\gdal-data\s57attributes.csv" Vital="yes"/>
                        </Component>
                        <Component Id="s57expectedinput.csv" Guid="*">
                            <File Id="s57expectedinput.csv" Name="s57expectedinput.csv" Source="$(var.TargetDir)\gdal-data\s57expectedinput.csv" Vital="yes"/>
                        </Component>
                        <Component Id="s57objectclasses.csv" Guid="*">
                            <File Id="s57objectclasses.csv" Name="s57objectclasses.csv" Source="$(var.TargetDir)\gdal-data\s57objectclasses.csv" Vital="yes"/>
                        </Component>
                        <Component Id="stateplane.csv" Guid="*">
                            <File Id="stateplane.csv" Name="stateplane.csv" Source="$(var.TargetDir)\gdal-data\stateplane.csv" Vital="yes"/>
                        </Component>
                        <Component Id="unit_of_measure.csv" Guid="*">
                            <File Id="unit_of_measure.csv" Name="unit_of_measure.csv" Source="$(var.TargetDir)\gdal-data\unit_of_measure.csv" Vital="yes"/>
                        </Component>
                        <?if $(var.VersionTag) = 18 Or $(var.VersionTag) = 18dev Or $(var.VersionTag) = 19dev Or $(var.VersionTag) = 19?>
                        <Component Id="compdcs.csv" Guid="*">
                            <File Id="compdcs.csv" Name="compdcs.csv" Source="$(var.TargetDir)\gdal-data\compdcs.csv" Vital="yes"/>
                        </Component>
                        <Component Id="vertcs.csv" Guid="*">
                            <File Id="vertcs.csv" Name="vertcs.csv" Source="$(var.TargetDir)\gdal-data\vertcs.csv" Vital="yes"/>
                        </Component>
                        <Component Id="vertcs.override.csv" Guid="*">
                            <File Id="vertcs.override.csv" Name="vertcs.override.csv" Source="$(var.TargetDir)\gdal-data\vertcs.override.csv" Vital="yes"/>
                        </Component>
                        <Component Id="datum_shift.csv" Guid="*">
                            <File Id="datum_shift.csv" Name="datum_shift.csv" Source="$(var.TargetDir)\gdal-data\datum_shift.csv" Vital="yes"/>
                        </Component>
                        <Component Id="pci_datum.txt" Guid="*">
                            <File Id="pci_datum.txt" Name="pci_datum.txt" Source="$(var.TargetDir)\gdal-data\pci_datum.txt" Vital="yes"/>
                        </Component>
                        <Component Id="pci_ellips.txt" Guid="*">
                            <File Id="pci_ellips.txt" Name="pci_ellips.txt" Source="$(var.TargetDir)\gdal-data\pci_ellips.txt" Vital="yes"/>
                        </Component>
                        <?endif?>
                        <Component Id="header.dxf" Guid="*">
                            <File Id="header.dxf" Name="header.dxf" Source="$(var.TargetDir)\gdal-data\header.dxf" Vital="yes"/>
                        </Component>
                        <Component Id="trailer.dxf" Guid="*">
                            <File Id="trailer.dxf" Name="trailer.dxf" Source="$(var.TargetDir)\gdal-data\trailer.dxf" Vital="yes"/>
                        </Component>
                        <Component Id="seed_2d.dgn" Guid="*">
                            <File Id="seed_2d.dgn" Name="seed_2d.dgn" Source="$(var.TargetDir)\gdal-data\seed_2d.dgn" Vital="yes"/>
                        </Component>
                        <Component Id="seed_3d.dgn" Guid="*">
                            <File Id="seed_3d.dgn" Name="seed_3d.dgn" Source="$(var.TargetDir)\gdal-data\seed_3d.dgn" Vital="yes"/>
                        </Component>
                    </Directory>
                    
                    <?endif?>
                </Directory>
            </Directory>

            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDirMapServer" Name="MapServer" >
                    <Component Id="ApplicationShortcut" Guid="*">
                        <?ifdef gdal_dll?>
                        <Shortcut Id="commandpromptMapServer" Target="[SystemFolder]cmd.exe" Arguments="/k &quot;[INSTALLDIR]MSShell.bat&quot;" WorkingDirectory="INSTALLDIR" Name="$(var.ProductName) Command Prompt" />
                        <util:InternetShortcut Id="startpage" Name="Start Page" Target="http://localhost/[WEB_APP_NAME]/content/index.html" Type="url"/>
                        <?endif?>
                        <Shortcut Id="UninstallProduct" Name="Uninstall MapServer $(var.ProductName)" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" Description="Uninstalls $(var.ProductName)" />
                        <RemoveFolder Id="ProgramMenuDirMapServer" On="uninstall"/>
                        <RegistryValue Root="HKCU" Key="Software\OSGeo\$(var.UpgradeCode)" Name="location" Type="string" Value="[INSTALLDIR]" Action="write" KeyPath="yes"/>
                    </Component>
                </Directory>
            </Directory>

        </Directory>

        <!-- As my requirements dictated that my install should always go to an
           existing web site, I'm using this outside of a Component. Inside 
           a Component, <WebSite> creates a new Web Site. Outside a Component,
           it's a look up. Note that I'm using a property here to be able to
           reassign it on the fly. -->
        <iis:WebSite Id="TheWebSite"
                     Description="[WEBSITE_NAME]"
                     Directory="INSTALLDIR">
          <!-- This element has to be here or WiX does not compile. It's ignored in this case. -->
          <iis:WebAddress Id="AllUnassigned" Port="80"/>
        </iis:WebSite>

        <iis:WebAppPool Id="TheAppPool" Name="[APP_POOL_NAME]"/>

        <UI>
            <!--<Dialog Id="WebAppInstallDlg" Width="370" Height="270" Title="!(loc.InstallDirDlg_Title)">
              <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)" />
              <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
              <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
                <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
              </Control>
              <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.WebAppInstallDlgDescription)" />
              <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.WebAppInstallDlgTitle)" />
              <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.InstallDirDlgBannerBitmap)" />
              <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
              <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
              <Control Id="WebSiteLabel" Type="Text" X="20" Y="60" Width="290" Height="15" NoPrefix="yes" Text="!(loc.WebAppInstallDlgWebSiteLabel)" />
              <Control Type="ComboBox" Property="WEBSITE_NAME" Id="WebSiteCombo" Width="320" Height="16" X="20" Y="80" ComboList="yes" Sorted="yes" />
              <Control Type="Text" Id="AppNameLabel" Width="320" Height="15" X="20" Y="105" Text="!(loc.WebAppInstallDlgAppNameLabel)" />
              <Control Type="Edit" Id="AppNameEdit" Width="320" Height="15" X="20" Y="125" Property="WEB_APP_NAME" />
              <Control Type="CheckBox" Property="USE_CUSTOM_APP_POOL" CheckBoxValue="1" Id="CustomAppPoolCheckBox" Width="320" Height="15" X="20" Y="150" Text="!(loc.WebAppInstallDlgUseCustomAppPool)"  />
              <Control Type="Text" Id="AppPoolLabel" Width="300" Height="15" X="40" Y="170" Text="!(loc.WebAppInstallDlgAppPoolLabel)">
                <Condition Action ="enable">USE_CUSTOM_APP_POOL = 1</Condition>
                <Condition Action="disable"><![CDATA[USE_CUSTOM_APP_POOL <> 1]]></Condition>
              </Control>
              <Control Type="Text" Property="APP_POOL_NAME" Id="AppPoolCombo" Width="300" Height="16" X="40" Y="190"  Text="DefaultAppPool">
                <Condition Action ="enable">USE_CUSTOM_APP_POOL = 1</Condition>
                <Condition Action="disable"><![CDATA[USE_CUSTOM_APP_POOL <> 1]]></Condition>
              </Control>
            </Dialog>-->
            <UIRef Id="WixUI_Mondo" />
            <UIRef Id="WixUI_ErrorProgressText" />
            <!--<InstallUISequence>
              <Show Dialog="WebAppInstallDlg" After="MigrateFeatureStates">NOT Installed</Show>
            </InstallUISequence>-->
        </UI>

        <?ifdef gdal_dll?>
        <WixVariable Id="WixUILicenseRtf" Value="$(var.BaseDir)\wixprojects\mapserver\MSLicense.rtf" />
        <?endif?>
        <?ifdef msplugin_oracle?>
        <WixVariable Id="WixUILicenseRtf" Value="$(var.BaseDir)\wixprojects\mapserver\OCILicense.rtf" />
        <?endif?>
        <WixVariable Id="WixUIBannerBmp" Value="$(var.BaseDir)\wixprojects\mapserver\bannrbmpMapServer.bmp" />
        <WixVariable Id="WixUIDialogBmp" Value="$(var.BaseDir)\wixprojects\mapserver\dlgbmpMapServer.bmp" />

        <?ifdef gdal_dll?>
        <Feature Id="MainProgram" Level="1" Title="Core Components" Absent="disallow" Description="The core components of the package">
            <ComponentRef Id="mapserver.dll" />
            <ComponentRef Id="cairo.dll" />
            <ComponentRef Id="fribidi.dll" />
            <ComponentRef Id="libfcgi.dll" />
            <ComponentRef Id="mapserv.exe" />
            <ComponentRef Id="gdal.dll" />
            <?if $(var.Compiler) = 1310?>
            <ComponentRef Id="msvcr71.dll" />
            <ComponentRef Id="msvcp71.dll" />
            <?endif?>
            <ComponentRef Id="geos_c.dll" />
			<ComponentRef Id="geos.dll" />
            <ComponentRef Id="iconv.dll" />
            <ComponentRef Id="libcurl.dll" />
            <ComponentRef Id="curl_ca_bundle.crt" />
            <ComponentRef Id="ssleay32.dll" />
            <ComponentRef Id="libeay32.dll" />
            <ComponentRef Id="expat.dll" />
            <ComponentRef Id="libpq.dll" />
            <ComponentRef Id="libmysql.dll" />
            <ComponentRef Id="libxml2.dll" />
            <ComponentRef Id="proj.dll" />
            <ComponentRef Id="spatialite.dll" />
			<ComponentRef Id="sqlite3.dll" />
			<ComponentRef Id="freexl.dll" />
            <ComponentRef Id="xerces_c_3_1.dll" />
            <ComponentRef Id="openjp2.dll" />
            <ComponentRef Id="zlib1.dll" />
            <ComponentRef Id="ApplicationShortcut" />
            <ComponentRef Id="MSLicense.rtf" />
			<ComponentRef Id="GDALLicense.rtf" />
            <ComponentRef Id="epsg" />
            <ComponentRef Id="world" />
            <ComponentRef Id="WO" />
            <ComponentRef Id="WI" />
            <ComponentRef Id="TN" />
            <ComponentRef Id="stpaul" />
            <ComponentRef Id="stlrnc" />
            <ComponentRef Id="stgeorge" />
            <ComponentRef Id="prvi" />
            <ComponentRef Id="proj_def.dat" />                
            <ComponentRef Id="other.extra" />
            <ComponentRef Id="nzgd2kgrid0005.gsb" />
            <ComponentRef Id="null" />
            <ComponentRef Id="ntv1_can.dat" />
            <ComponentRef Id="ntf_r93.gsb" />
            <ComponentRef Id="nad83" />
            <ComponentRef Id="nad27" />
            <ComponentRef Id="nad.lst" />
            <ComponentRef Id="MD" />
            <ComponentRef Id="IGNF" />
            <ComponentRef Id="hawaii" />
            <ComponentRef Id="GL27" />
            <ComponentRef Id="esri.extra" />
            <ComponentRef Id="esri" />
            <ComponentRef Id="conus" />
            <ComponentRef Id="alaska" />
            <ComponentRef Id="ecw_cs.wkt" />
            <ComponentRef Id="cubewerx_extra.wkt" />
            <ComponentRef Id="epsg.wkt" />
            <ComponentRef Id="esri_extra.wkt" />
            <ComponentRef Id="coordinate_axis.csv" />
            <ComponentRef Id="ellipsoid.csv" />
            <ComponentRef Id="gcs.csv" />
            <ComponentRef Id="gcs.override.csv" />
            <ComponentRef Id="gdal_datum.csv" />
            <ComponentRef Id="gt_datum.csv" />
            <ComponentRef Id="gt_ellips.csv" />
            <ComponentRef Id="pcs.csv" />
            <ComponentRef Id="pcs.override.csv" />
            <ComponentRef Id="prime_meridian.csv" />
            <ComponentRef Id="projop_wparm.csv" />
            <ComponentRef Id="s57agencies.csv" />
            <ComponentRef Id="s57attributes.csv" />
            <ComponentRef Id="s57expectedinput.csv" />
            <ComponentRef Id="s57objectclasses.csv" />
            <ComponentRef Id="stateplane.csv" />
            <ComponentRef Id="unit_of_measure.csv" />
            <?if $(var.VersionTag) = 18 Or $(var.VersionTag) = 18dev Or $(var.VersionTag) = 19dev Or $(var.VersionTag) = 19?>
            <ComponentRef Id="vertcs.csv" />
            <ComponentRef Id="compdcs.csv" />
            <ComponentRef Id="vertcs.override.csv" />
            <ComponentRef Id="datum_shift.csv" />
            <ComponentRef Id="pci_ellips.txt" />
            <ComponentRef Id="pci_datum.txt" />
            <?endif?>
            <ComponentRef Id="seed_3d.dgn" />
            <ComponentRef Id="seed_2d.dgn" />
            <ComponentRef Id="trailer.dxf" />
            <ComponentRef Id="header.dxf" />
            <ComponentRef Id="MSShell.bat" />
			
			<ComponentRef Id="blank.gif" />
            <ComponentRef Id="east_mini.png" />
            <ComponentRef Id="west_mini.png" />
            <ComponentRef Id="north_mini.png" />
            <ComponentRef Id="south_mini.png" />
            <ComponentRef Id="zoom_minus_mini.png" />
            <ComponentRef Id="zoom_plus_mini.png" />
            <ComponentRef Id="zoom_world_mini.png" />
            <ComponentRef Id="style.css" />
        </Feature>
      
        <Feature Id="MSRegIIS" Level="1" Title="IIS Registration" Absent="disallow" Description="Register MapServer in IIS">
            <ComponentRef Id="IIS.Component" />
            <ComponentRef Id="SetupRegistryValues" />
            <ComponentRef Id="AppWebConfig" />
            <ComponentRef Id="index.html" />
        </Feature>

        <Feature Id="Utilities" Level="1" Title="Utilities" Display="expand" Description="Utility Programs">
            <Feature Id="MapServerUtilities" Level="1" Title="MapServer Utilities" Display="expand" Description="MapServer Utilities">
                <ComponentRef Id="legend.exe" />
                <ComponentRef Id="msencrypt.exe" />
                <ComponentRef Id="scalebar.exe" />
                <ComponentRef Id="shp2img.exe" />
                <ComponentRef Id="shptree.exe" />
                <ComponentRef Id="shptreevis.exe" />
                <ComponentRef Id="sortshp.exe" />
                <ComponentRef Id="tile4ms.exe" />
            </Feature>
            <Feature Id="GDALUtilities" Level="1" Title="GDAL Utilities" Display="expand" Description="GDAL Utilities">
                <ComponentRef Id="gdal_contour.exe" />
                <ComponentRef Id="gdal_grid.exe" />
                <ComponentRef Id="gdal_rasterize.exe" />
                <ComponentRef Id="gdal_translate.exe" />
                <ComponentRef Id="gdaladdo.exe" />
                <ComponentRef Id="gdalbuildvrt.exe" />
                <ComponentRef Id="gdaldem.exe" />
                <ComponentRef Id="gdalenhance.exe" />
                <ComponentRef Id="gdalinfo.exe" />
                <ComponentRef Id="gdallocationinfo.exe" />
                <ComponentRef Id="gdalmanage.exe" />
                <ComponentRef Id="gdaltindex.exe" />
                <ComponentRef Id="gdaltransform.exe" />
                <ComponentRef Id="gdalwarp.exe" />
                <ComponentRef Id="nearblack.exe" />
                <ComponentRef Id="ogr2ogr.exe" />
                <ComponentRef Id="ogrinfo.exe" />
                <ComponentRef Id="ogrtindex.exe" />
            </Feature>
            <Feature Id="PROJ4Utilities" Level="1" Title="Proj.4 Utilities" Display="expand" Description="Proj.4 Utilities">
                <ComponentRef Id="cs2cs.exe" />
                <ComponentRef Id="geod.exe" />
                <ComponentRef Id="nad2bin.exe" />
                <ComponentRef Id="proj.exe" />
            </Feature>
            <Feature Id="CURLUtilities" Level="1" Title="LibCurl Utilities" Display="expand" Description="LibCurl Utilities">
                <ComponentRef Id="curl.exe" />
                <ComponentRef Id="openssl.exe" />
            </Feature>
        </Feature>
        <Feature Id="GDALPlugins" Level="1" Title="GDAL Plugins" Display="expand" Description="GDAL plugin library files">
            <Feature Id="NetCDF" Level="1" Title="NetCDF" Description="Network Common Data Form (NetCDF) rasters (for the custom licensing terms please review NetCDFLicense.rtf and SZIPLicense.rtf installed in the /license folder)">
                <ComponentRef Id="gdal_netCDF.dll" />
                <ComponentRef Id="gdal_GMT.dll" />
                <ComponentRef Id="netcdf.dll" />
                <ComponentRef Id="NetCDFLicense.rtf" />
                <ComponentRef Id="hdf5.dll" />
                <ComponentRef Id="hdf5_hl.dll" />
                <ComponentRef Id="HDF5License.rtf" />
                <ComponentRef Id="SZIPLicense.rtf" />
                <ComponentRef Id="szip.dll" />
            </Feature>
			<Feature Id="HDF4" Level="1" Title="HDF4" Description="Hierarchical Data Format Release 4 (HDF4) rasters (for the custom licensing terms please review HDF4License.rtf and SZIPLicense.rtf installed in the /license folder)">
                <ComponentRef Id="gdal_HDF4.dll" />
                <ComponentRef Id="gdal_HDF4Image.dll" />
                <ComponentRef Id="hdfdll.dll" />
                <ComponentRef Id="mfhdfdll.dll" />
                <ComponentRef Id="xdrdll.dll" />
                <ComponentRef Id="HDF4License.rtf" />
                <ComponentRef Id="SZIPLicense.rtf" />
                <ComponentRef Id="szip.dll" />
            </Feature>
            <Feature Id="HDF5" Level="1" Title="HDF5" Description="Hierarchical Data Format Release 5 (HDF5) rasters (for the custom licensing terms please review HDF5License.rtf and SZIPLicense.rtf installed in the /license folder)">
                <ComponentRef Id="gdal_HDF5.dll" />
                <ComponentRef Id="gdal_BAG.dll" />
                <ComponentRef Id="gdal_HDF5Image.dll" />
                <ComponentRef Id="hdf5.dll" />
                <ComponentRef Id="hdf5_hl.dll" />
                <ComponentRef Id="HDF5License.rtf" />
                <ComponentRef Id="SZIPLicense.rtf" />
                <ComponentRef Id="szip.dll" />
            </Feature>
            <Feature Id="FITS" Level="1" Title="FITS" Description="Flexible Image Transport System (FITS) rasters (for the custom licensing terms please review FITSLicense.rtf installed in the /license folder)">
                <ComponentRef Id="gdal_FITS.dll" />
                <ComponentRef Id="cfitsio.dll" />
                <ComponentRef Id="FITSLicense.rtf" />
            </Feature>

        </Feature>
        <Feature Id="CSharpBindings" Level="1" Title="CSharp Bindings" Display="expand" Description="GDAL CSharp Bindings">
            <ComponentRef Id="ogr_csharp.dll" />
            <ComponentRef Id="ogr_wrap.dll" />
            <ComponentRef Id="osr_csharp.dll" />
            <ComponentRef Id="osr_wrap.dll" />
            <ComponentRef Id="gdal_csharp.dll" />
            <ComponentRef Id="gdal_wrap.dll" />
        </Feature>
        <Feature Id="JavaBindings" Level="1" Title="Java Bindings" Display="expand" Description="GDAL Java Bindings">
            <ComponentRef Id="gdal.jar" />
            <ComponentRef Id="gdalconstjni.dll" />
            <ComponentRef Id="gdaljni.dll" />
            <ComponentRef Id="ogrjni.dll" />
            <ComponentRef Id="osrjni.dll" />
        </Feature>
        <Feature Id="PythonBindings" Level="1" Title="Python Applications" Display="expand" Description="GDAL Python Applications (The bindings are installed separately)">
            <ComponentRef Id="epsg_tr.py" />
            <ComponentRef Id="esri2wkt.py" />
            <ComponentRef Id="gcps2vec.py" />
            <ComponentRef Id="gcps2wld.py" />
            <ComponentRef Id="gdal2tiles.py" />
            <ComponentRef Id="gdal2xyz.py" />
            <ComponentRef Id="gdal_fillnodata.py" />
            <ComponentRef Id="gdal_merge.py" />
            <ComponentRef Id="gdal_polygonize.py" />
            <ComponentRef Id="gdal_proximity.py" />
            <ComponentRef Id="gdal_retile.py" />
            <ComponentRef Id="gdal_sieve.py" />
            <ComponentRef Id="gdalchksum.py" />
            <ComponentRef Id="gdalident.py" />
            <ComponentRef Id="gdalimport.py" />
            <ComponentRef Id="mkgraticule.py" />
            <ComponentRef Id="pct2rgb.py" />
            <ComponentRef Id="rgb2pct.py" />
        </Feature>
        <?endif?>
        <?ifdef msplugin_oracle?>
        <Feature Id="msplugin_oracle" Level="1" Title="OCI" Absent="disallow" Description="Oracle OCI vercor data sources. This component requires the OCI client libraries to be installed previously.">
            <ComponentRef Id="msplugin_oracle.dll" />
            <ComponentRef Id="gdal_GEOR.dll" />
            <ComponentRef Id="ApplicationShortcut" />
            <ComponentRef Id="OCILicense.rtf" />
        </Feature>
        <?endif?>
        
        <?ifdef gdal_dll?>
        <?if $(var.Compiler) = 1400?>
		<?if $(sys.BUILDARCH) = x64?>
		<DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC80_CRT_x86_x64.msm" DiskId="1" Language="0"/>
			<Merge Id="VCRedist2" SourceFile="$(var.BaseDir)\policy_8_0_Microsoft_VC80_CRT_x86_x64.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 8.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
			<MergeRef Id="VCRedist2"/>
        </Feature>
        <?else?>
        <DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC80_CRT_x86.msm" DiskId="1" Language="0"/>
			<Merge Id="VCRedist2" SourceFile="$(var.BaseDir)\policy_8_0_Microsoft_VC80_CRT_x86.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 8.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
			<MergeRef Id="VCRedist2"/>
        </Feature>
		<?endif?>
        <?elseif $(var.Compiler) = 1500?>
		<?if $(sys.BUILDARCH) = x64?>
		<DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC90_CRT_x86_x64.msm" DiskId="1" Language="0"/>
			<Merge Id="VCRedist2" SourceFile="$(var.BaseDir)\policy_9_0_Microsoft_VC90_CRT_x86_x64.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 9.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
			<MergeRef Id="VCRedist2"/>
        </Feature>
        <?else?>
        <DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC90_CRT_x86.msm" DiskId="1" Language="0"/>
			<Merge Id="VCRedist2" SourceFile="$(var.BaseDir)\policy_9_0_Microsoft_VC90_CRT_x86.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 9.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
			<MergeRef Id="VCRedist2"/>
        </Feature>
		<?endif?>
        <?elseif $(var.Compiler) = 1600?>
		<?if $(sys.BUILDARCH) = x64?>
		<DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC100_CRT_x64.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 10.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
        <?else?>
        <DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC100_CRT_x86.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 10.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
		<?endif?>
				<?elseif $(var.Compiler) = 1700?>
		<?if $(sys.BUILDARCH) = x64?>
		<DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC110_CRT_x64.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 11.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
        <?else?>
        <DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC110_CRT_x86.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 11.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
		<?endif?>
		<?elseif $(var.Compiler) = 1800?>
		<?if $(sys.BUILDARCH) = x64?>
		<DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC120_CRT_x64.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 12.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
        <?else?>
        <DirectoryRef Id="TARGETDIR">
            <Merge Id="VCRedist" SourceFile="$(var.BaseDir)\Microsoft_VC120_CRT_x86.msm" DiskId="1" Language="0"/>
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ 12.0 Runtime" AllowAdvertise="no" Display="hidden" Level="1">
            <MergeRef Id="VCRedist"/>
        </Feature>
		<?endif?>
        <?endif?>
        <?endif?>
	</Product>
</Wix>
